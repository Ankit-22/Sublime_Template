#!/bin/bash

if [ $# = 0 ]; then
	subl
	exit 0
fi

if [ ! -d ~/.template ]; then
	mkdir ~/.template/
fi

if [ $1 = 'create' ]; then 
	if [ $# = 3 ]; then
		mkdir ~/.template/$2
		cp $3 ~/.template/$2/template
	else
		echo "Format: sublime create < name > < template file >"
		exit 0
	fi

elif [ $1 = '+x' ]; then
	while [ $# -gt 1 ]; do
		touch $2
		chmod +x $2
		subl $2
		shift
	done

elif [ "`echo $1 | grep -- --`" != "" ]; then
	template_type=`echo $1 | sed 's/^..//'`
	echo $template_type
	if [ -d ~/.template/$template_type -a -r ~/.template/$template_type/template ]; then
		while [ $# -gt 1 ]; do
			touch $2
			cp ~/.template/$template_type/template $2
			subl $2
			shift
		done
	else
		echo "Invalid template name: $template_type"
		exit 0
	fi

else
	exec /opt/sublime_text/sublime_text "$@"
	exit 0
fi
